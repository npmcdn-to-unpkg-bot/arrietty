<h1>Preferences</h1>


<label>email:</label>
<%= @user.email %>

<label>location:</label>
<input type='text' id='location' placeholder='Where am I?'/>
<button id='locateMeButton'>Locate me</button>


<script>
  $(function () {
    $('#locateMeButton').on('click', locateMe);
  });
  
  function locateMe() {
    navigator.geolocation.getCurrentPosition(function (pos) {
      $.ajax('/preferences', {
          async: true,
          data: {
            position: pos
          },
          method: 'POST',
          dataType: 'json'
        })
        .done(function(result) {
          $('#location').val(result.address);
        });
    }, null, null);
  }
</script>
